<!DOCTYPE html>
<html lang="fr" data-theme="night">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Neo Survivors Idle</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/dist/tabler-icons.min.css" />
  <link rel="stylesheet" href="./public/assets/styles/main.css" />
</head>

<body>
  <header class="topbar">
    <div class="topbar-left">
      <img src="./public/assets/logo.svg" alt="Neo Survivors Idle Logo" class="game-logo" />
      <div>
        <p class="eyebrow">Incremental x Survivors</p>
        <h1>Neo Survivors Idle</h1>
        <p class="lede">Un auto-battler infini, 100% client-side, qui tourne mÃªme quand tu fermes l'onglet.</p>
      </div>
    </div>
    <div class="cta">
      <button id="resetProgress" class="ghost"><i class="ti ti-refresh"></i> Reset</button>
      <button id="toggleSound" class="ghost"><i class="ti ti-volume"></i> Son</button>
      <button id="togglePerf" class="ghost"><i class="ti ti-gauge"></i> Perfo</button>
      <button id="pause" class="primary"><i class="ti ti-player-pause"></i> Pause</button>
    </div>
  </header>

  <!-- HUD Toggle Buttons -->
  <button id="toggleUpgradeBarBtn" class="hud-toggle-btn active" aria-label="Afficher/Masquer les amÃ©liorations" title="AmÃ©liorations">
    <i class="ti ti-arrow-big-up-lines"></i>
    <span>AmÃ©liorations</span>
  </button>
  <button id="toggleRunStatsBtn" class="hud-toggle-btn active" aria-label="Afficher/Masquer les statistiques" title="Stats du run">
    <i class="ti ti-chart-bar"></i>
  </button>
  <button id="togglePerfHudBtn" class="hud-toggle-btn active" aria-label="Afficher/Masquer les performances" title="Performance">
    <i class="ti ti-chart-line"></i>
  </button>

  <!-- Upgrades horizontal bar -->
  <div id="upgradeBar" class="upgrade-bar" aria-label="AmÃ©liorations fragments"></div>

  <!-- Fullscreen canvas background -->
  <canvas id="webgl2" class="fullscreen-canvas" width="1920" height="1080"></canvas>

  <!-- Global Stats HUD (bottom-left, top position) -->
  <div class="hud-card global-stats-hud">
    <h2><i class="ti ti-trophy"></i> Statistiques globales</h2>
    <div class="hud-card-content">
      <div class="stat-row">
        <span><i class="ti ti-target stat-icon"></i> Meilleure vague</span>
        <span id="hudBestWave">1</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-skull stat-icon"></i> Kills totaux</span>
        <span id="hudTotalKills">0</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-diamond stat-icon"></i> Fragments run</span>
        <span id="hudRunFragments">0</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-droplet stat-icon"></i> Essence run</span>
        <span id="hudRunEssence">0</span>
      </div>
    </div>
  </div>

  <!-- Merged Run Status & Calculated Values HUD (bottom-left) -->
  <div class="hud-card merged-run-hud">
    <h2><i class="ti ti-sword"></i> Run en cours</h2>
    <div class="hud-card-content">
      <div class="stat-row"><span><i class="ti ti-wave-square stat-icon"></i> Vague</span><span id="wave">1</span>
      </div>
      <div class="stat-row"><span><i class="ti ti-heart stat-icon"></i> Vie</span><span id="hp">100</span></div>
      <div class="stat-row tooltip" id="damageRow"><span><i class="ti ti-sword stat-icon"></i> DÃ©gÃ¢ts</span><span
          id="dps">0</span></div>
      <div class="stat-row"><span><i class="ti ti-flame stat-icon"></i> Critiques</span><span id="crit">0%</span>
      </div>
      <div class="stat-row"><span><i class="ti ti-shield stat-icon"></i> Bouclier</span><span id="shield">0%</span>
      </div>
      <div class="stat-row"><span><i class="ti ti-magnet stat-icon"></i> Collecte</span><span id="collect">0</span>
      </div>
      <div class="stat-row muted"><span><i class="ti ti-clock stat-icon"></i> Spawn</span><span
          id="spawnRate">0/s</span></div>
    </div>
    <h2><i class="ti ti-calculator"></i> Valeurs calculÃ©es</h2>
    <div class="hud-card-content">
      <div class="stat-row">
        <span><i class="ti ti-sword stat-icon"></i> DPS joueur</span>
        <span id="hudLiveDps">0</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-clock stat-icon"></i> Spawn actuel</span>
        <span id="hudLiveSpawnRate">0 /s</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-heart stat-icon"></i> HP ennemis</span>
        <span id="hudLiveEnemyHp">0</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-speed stat-icon"></i> Vitesse ennemis</span>
        <span id="hudLiveEnemySpeed">0</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-star stat-icon"></i> Chance Ã©lite</span>
        <span id="hudLiveEliteChance">0%</span>
      </div>
    </div>
  </div>

  <!-- Performance HUD (bottom right) -->
  <div id="performanceHud" class="performance-hud">
    <div class="performance-header"><i class="ti ti-chart-line"></i> Performance</div>
    <div class="performance-content">
      <div class="perf-row">
        <span class="perf-label">FPS</span>
        <span id="hudFpsValue" class="perf-value">--</span>
      </div>
      <div class="perf-row">
        <span class="perf-label tooltip" data-tooltip="Temps du dernier rendu complet du jeu">Frame</span>
        <span id="hudFrameTime" class="perf-value">-- ms</span>
      </div>
      <div class="perf-row">
        <span class="perf-label tooltip" data-tooltip="Moyenne mobile sur les 240 derniÃ¨res frames">FPS moyen</span>
        <span id="hudAvgFps" class="perf-value">--</span>
      </div>
      <div class="perf-row tooltip" data-tooltip="Consommation mÃ©moire du navigateur (si disponible)">
        <span class="perf-label">MÃ©moire</span>
        <span id="hudMemory" class="perf-value">--</span>
      </div>
      <button id="toggleFpsFromHud" class="ghost small"><i class="ti ti-chart-area"></i> Graph</button>
      <canvas id="fpsGraphHud" class="fps-chart-hud" width="180" height="60"></canvas>
    </div>
  </div>

  <!-- Active Weapons HUD (bottom right, below performance) -->
  <div class="hud-card weapons-hud">
    <h2><i class="ti ti-swords"></i> Armes actives</h2>
    <div class="hud-card-content">
      <div class="stat-row">
        <span><i class="ti ti-check stat-icon"></i> DÃ©bloquÃ©es</span>
        <span id="hudUnlockedWeapons">0</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-bolt stat-icon"></i> Arme principale</span>
        <span id="hudMainWeapon">--</span>
      </div>
      <div class="stat-row">
        <span><i class="ti ti-shield-checkered stat-icon"></i> Support actifs</span>
        <span id="hudSupportWeapons">0</span>
      </div>
    </div>
  </div>

  <section class="block-workspace" data-block-workspace>
    <div class="floating-block" data-block-id="resources">
      <div class="stat-block collapsible">
        <h2><i class="ti ti-diamonds"></i> Ressources</h2>
        <div class="stat-row resource-row">
          <span><i class="ti ti-droplet-filled resource-icon essence"></i> Essence</span>
          <span id="essence" class="resource-value essence">0</span>
        </div>
        <div class="stat-row resource-row">
          <span><i class="ti ti-diamond-filled resource-icon fragments"></i> Fragments</span>
          <span id="fragments" class="resource-value fragments">0</span>
        </div>
        <div class="stat-row muted">
          <span><i class="ti ti-clock-hour-4"></i> Gain passif</span>
          <span id="idleRate">0 /s</span>
        </div>
      </div>
    </div>

    <div class="floating-block" data-block-id="run">
      <div class="stat-block collapsible">
        <h2><i class="ti ti-sword"></i> Run en cours</h2>
        <div class="stat-row muted">DÃ©placÃ© dans l'overlay de HUD.</div>
      </div>
    </div>

    <div class="floating-block" data-block-id="weapons">
      <div class="stat-block collapsible">
        <h2><i class="ti ti-swords"></i> Armes</h2>
        <div id="weaponsGrid" class="weapons-grid"></div>
      </div>
    </div>

    <div class="floating-block" data-block-id="generators">
      <div class="stat-block">
        <h2><i class="ti ti-building-factory"></i> Production</h2>
        <div id="generators" class="list"></div>
      </div>
    </div>

    <div class="floating-block" data-block-id="quickHelp">
      <div class="stat-block assist collapsible collapsed">
        <h2><i class="ti ti-bulb"></i> Aide rapide</h2>
        <ul id="quickHelpList" class="assist-list"></ul>
      </div>
    </div>

    <div class="floating-block" data-block-id="milestones">
      <div class="stat-block assist collapsible collapsed">
        <h2><i class="ti ti-target"></i> Jalons</h2>
        <ul id="milestoneList" class="assist-list milestones"></ul>
      </div>
    </div>

    <div class="floating-block" data-block-id="talents">
      <div class="stat-block collapsible">
        <h2><i class="ti ti-bolt"></i> Talents</h2>
        <div id="talents" class="talent-grid"></div>
        <div class="talent-actions">
          <p id="talentStatus" class="muted"></p>
          <button id="resetTalents" class="ghost danger"><i class="ti ti-trash"></i> Reset: 1200</button>
        </div>
      </div>
    </div>

    <div class="floating-block" data-block-id="upgrades">
      <div class="stat-block">
        <h2><i class="ti ti-arrow-big-up-lines"></i> AmÃ©liorations</h2>
        <div id="upgrades" class="list"></div>
      </div>
    </div>

    <div class="floating-block" data-block-id="prestige">
      <div class="stat-block collapsible">
        <h2><i class="ti ti-sparkles"></i> Prestige</h2>
        <button id="softPrestige" class="secondary"><i class="ti ti-stack-2"></i> Consolidation</button>
        <button id="restartRun" class="ghost"><i class="ti ti-rotate"></i> Relancer</button>
      </div>
    </div>

    <div class="floating-block" data-block-id="guide">
      <div class="stat-block collapsible collapsed">
        <h2><i class="ti ti-book"></i> Guide</h2>
        <ul class="guide">
          <li>> Investis Essence dans production passive</li>
          <li>> Fragments pour upgrades de combat</li>
          <li>> Consolidation = boost passif</li>
          <li>> Tir automatique avec critiques</li>
          <li>> Ã‰lites = + rewards + damage</li>
        </ul>
      </div>
    </div>

    <div class="floating-block" data-block-id="debug">
      <div class="stat-block collapsible collapsed debug">
        <h2><i class="ti ti-bug"></i> Debug</h2>
        <div class="debug-grid">
          <button id="debugGiveEssence" class="ghost">+1M ESS</button>
          <button id="debugGiveFragments" class="ghost">+1M FRG</button>
          <button id="debugSkipWave" class="ghost">+10 WAV</button>
          <button id="debugNuke" class="ghost">NUKE</button>
        </div>
      </div>
    </div>

    <div class="floating-block" data-block-id="tuning">
      <div class="stat-block collapsible collapsed debug">
        <h2><i class="ti ti-adjustments"></i> Tuning</h2>
        <div id="tuningPanel" class="tuning-panel"></div>
      </div>
    </div>
  </section>

  <!-- Bottom status overlay -->
  <div class="status-overlay">
    <p class="status" id="statusMessage"></p>
  </div>

  <footer class="footer">
    <p>Made for fun Â· Pas de serveur Â· Tout reste dans tes cookies</p>
  </footer>

  <div class="version-container">
    <button id="docBtn" class="doc-btn" aria-label="Ouvrir la documentation"><i class="ti ti-book-2"></i></button>
    <div id="versionBadge" class="version-badge"></div>
  </div>
  <div id="assistBubbles" class="assist-bubbles"></div>

  <dialog id="docDialog" class="doc-dialog" aria-labelledby="docDialogTitle">
    <div class="doc-dialog-header">
      <h2 id="docDialogTitle"><i class="ti ti-book-2"></i> Documentation</h2>
      <button class="doc-close-btn" aria-label="Fermer"><i class="ti ti-x"></i></button>
    </div>
    <div class="doc-tabs" id="docTabs">
      <button class="doc-tab" data-tab="code"><span class="tab-icon"><i class="ti ti-code"></i></span><span
          class="tab-label">Code</span></button>
      <button class="doc-tab" data-tab="wiki"><span class="tab-icon"><i class="ti ti-file-text"></i></span><span
          class="tab-label">Wiki</span></button>
      <button class="doc-tab" data-tab="changelog"><span class="tab-icon"><i class="ti ti-list-check"></i></span><span
          class="tab-label">Versions</span></button>
      <button class="doc-tab" data-tab="roadmap"><span class="tab-icon"><i class="ti ti-map"></i></span><span
          class="tab-label">Roadmap</span></button>
    </div>
    <div class="doc-content" id="docContent" role="region" aria-live="polite"></div>
  </dialog>

  <!-- Weapons Bar (bottom of screen) -->
  <div id="weaponsBar" class="weapons-bar">
    <div class="weapons-bar-header">
      <i class="ti ti-swords"></i> Armes <span class="currency-hint">(ðŸ’Ž Fragments)</span>
    </div>
    <div id="weaponsGrid" class="weapons-bar-grid"></div>
  </div>

  <script type="module" src="./src/main.ts"></script>
</body>

</html>